<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Imanes - Generación de Fichas</title>
    <style>
      /* Estilos críticos para evitar FOUC */
      * {
        box-sizing: border-box;
      }
      
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }
      
      /* Ocultar TODO el contenido hasta que CSS esté cargado */
      .imanes-container {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        position: absolute !important;
        left: -9999px !important;
      }
      
      .imanes-container.css-loaded {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        left: auto !important;
        padding: 1rem;
        height: 100vh;
        flex-direction: column;
        overflow: hidden;
        background-color: #f8fafc;
        transition: opacity 0.3s ease-in;
      }
      
      /* Loader inicial - siempre visible hasta que se oculte */
      .imanes-loader {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 99999;
        transition: opacity 0.4s ease-out, visibility 0.4s ease-out;
        margin: 0;
        padding: 0;
      }
      
      .imanes-loader.hidden {
        opacity: 0 !important;
        visibility: hidden !important;
        pointer-events: none !important;
        display: none !important;
        z-index: -1 !important;
      }
      
      .imanes-loader-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-top: 4px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 1.5rem;
      }
      
      .imanes-loader-text {
        color: white;
        font-size: 1.1rem;
        font-weight: 500;
        letter-spacing: 0.5px;
        margin: 0;
        padding: 0;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* Estilos críticos para el header icon - evitar SVG gigante */
      .header-icon {
        width: 28px !important;
        height: 28px !important;
        max-width: 28px !important;
        max-height: 28px !important;
        overflow: hidden !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
      }
      
      .header-icon svg {
        width: 28px !important;
        height: 28px !important;
        max-width: 28px !important;
        max-height: 28px !important;
        display: block !important;
        overflow: hidden !important;
      }
    </style>
  </head>
  <body>
    <!-- Loader inicial -->
    <div class="imanes-loader" id="imanes-loader">
      <div class="imanes-loader-spinner"></div>
      <div class="imanes-loader-text">Cargando Imanes...</div>
    </div>
    <div class="imanes-container" id="imanes-container">
      <!-- Header compacto con SVG dinámico -->
      <header class="app-header-card compact">
        <h1>
          <div id="header-banner-icon" class="header-icon" style="opacity: 0; visibility: hidden; width: 28px; height: 28px; max-width: 28px; max-height: 28px; overflow: hidden;">
            <!-- SVG se carga dinámicamente -->
          </div>
          Imanes
        </h1>
      </header>

      <!-- Contenido principal -->
      <div class="imanes-content" id="imanes-content">
        <!-- Barra de selección compacta -->
        <div class="selection-bar">
          <!-- Input con autocompletado -->
          <div class="search-wrapper">
            <input
              type="text"
              id="search-login"
              placeholder="Buscar login o nombre..."
              autocomplete="off"
            />
            <div id="autocomplete-list" class="autocomplete-list"></div>
          </div>

          <!-- Botones de selección múltiple -->
          <div class="turno-filter">
            <button id="btn-agregar-turno" class="btn btn-sm btn-secondary" title="Agregar usuarios del turno">
              + Por Turno
            </button>
            <button id="btn-agregar-manager" class="btn btn-sm btn-secondary" title="Agregar usuarios por manager">
              + Por Manager
            </button>
          </div>

          <!-- Toggle colorear formaciones -->
          <div class="toggle-option">
            <label class="toggle-switch">
              <input type="checkbox" id="toggle-colorear-formaciones" />
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label">Colorear formaciones</span>
          </div>

          <!-- Toggle colores estándar/personalizado -->
          <div class="toggle-option">
            <label class="toggle-switch">
              <input type="checkbox" id="toggle-color-personalizado" />
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label" id="label-modo-color">Estándar</span>
          </div>

          <!-- Acciones -->
          <div class="action-buttons">
            <button id="btn-limpiar-seleccion" class="btn btn-sm btn-outline">
              Limpiar
            </button>
            <button id="btn-generar-preview" class="btn btn-sm btn-primary">
              Generar
            </button>
            <button id="btn-exportar-pdf" class="btn btn-sm btn-success" disabled>
              PDF
            </button>
          </div>
        </div>

        <!-- Lista de logins seleccionados (compacta) -->
        <div class="selected-bar" id="selected-bar" style="display: none;">
          <span class="selected-label">Seleccionados (<span id="selected-count">0</span>):</span>
          <div id="selected-logins-list" class="selected-chips">
            <!-- Chips de logins seleccionados -->
          </div>
        </div>

        <!-- Panel de personalización de colores (solo visible en modo personalizado) -->
        <div class="customization-panel" id="customization-panel" style="display: none;">
          <div class="customization-content" id="customization-content">
            <div class="color-option">
              <label for="color-turno">Turno:</label>
              <input type="color" id="color-turno" value="#c2c1c0" />
            </div>
            <div class="color-option">
              <label for="color-login">Login:</label>
              <input type="color" id="color-login" value="#606161" />
            </div>
            <div class="color-option">
              <label for="color-variacion">Variación:</label>
              <input type="color" id="color-variacion" value="#3a3838" />
            </div>
            <div class="color-option">
              <label for="color-type-aa">Type AA:</label>
              <input type="color" id="color-type-aa" value="#29ade4" />
            </div>
          </div>
        </div>

        <!-- Sección de vista previa (área principal) -->
        <div class="preview-section initializing" id="preview-section">
          <div class="preview-card">
            <div class="preview-header">
              <h2>Vista Previa</h2>
            </div>
            <div class="preview-content">
              <div id="imanes-preview" class="imanes-preview">
                <div class="initializing-preview">
                  <div class="spinner"></div>
                  <p>Inicializando Imanes...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Notificación Toast -->
    <div id="toast-notification" class="toast" style="display: none;"></div>
  </body>
</html>
