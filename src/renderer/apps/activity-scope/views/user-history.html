<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User History - Activity Scope</title>
    <!-- CSS se carga din谩micamente por el router -->
  </head>
  <body>
    <div class="user-history-container">
      <!-- Header compacto -->
      <header class="app-header-card">
        <h1>
          <span id="icon-history-header" class="icon-svg icon-32"></span>
          User History
        </h1>
        <div class="app-header-controls">
          <button id="refresh-history" class="btn btn-primary">
            <span id="icon-refresh-history" class="icon-svg icon-16"></span>
            Actualizar
          </button>
        </div>
      </header>

      <!-- Filtros compactos en una l铆nea -->
      <div class="user-history-filters-compact">
        <div class="filters-row">
          <!-- B煤squeda por login (PRIMERO, no afectada por filtros) -->
          <div class="filter-item filter-item-search">
            <label for="history-user-search">Buscar por Login:</label>
            <input 
              type="text" 
              id="history-user-search" 
              class="form-control compact search-input" 
              placeholder="Escribe el login..."
              autocomplete="off"
            />
            <div id="user-search-suggestions" class="search-suggestions" style="display: none;"></div>
          </div>
          <div class="filter-item">
            <label for="history-shift-filter">Turno:</label>
            <select id="history-shift-filter" class="form-control compact">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="filter-item">
            <label for="history-manager-filter">Manager:</label>
            <select id="history-manager-filter" class="form-control compact">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="filter-item filter-item-user">
            <label for="history-user-select">Usuario:</label>
            <select id="history-user-select" class="form-control compact">
              <option value="">-- Seleccionar --</option>
            </select>
          </div>
          <div class="filter-item filter-item-period">
            <div class="period-buttons-compact">
              <button class="period-btn-compact active" data-period="last_week">Semana</button>
              <button class="period-btn-compact" data-period="last_month">Mes</button>
              <button class="period-btn-compact" data-period="last_3_months">3 Meses</button>
              <button class="period-btn-compact" data-period="last_6_months">6 Meses</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Informaci贸n del usuario seleccionado (similar a user-activity) -->
      <div id="selected-user-info-card" class="selected-user-info-card" style="display: none;">
        <div class="user-info-photo-section">
          <div class="user-photo-large" id="selected-user-photo">
            <!-- Foto se cargar谩 din谩micamente -->
          </div>
        </div>
        <div class="user-info-details-section">
          <div class="user-info-row">
            <span class="user-info-label">Login:</span>
            <span class="user-info-value" id="selected-user-login">-</span>
          </div>
          <div class="user-info-row">
            <span class="user-info-label">Nombre:</span>
            <span class="user-info-value" id="selected-user-name">-</span>
          </div>
          <div class="user-info-row">
            <span class="user-info-label">Turno:</span>
            <span class="user-info-value" id="selected-user-shift">-</span>
          </div>
          <div class="user-info-row">
            <span class="user-info-label">Manager:</span>
            <span class="user-info-value" id="selected-user-manager">-</span>
          </div>
        </div>
      </div>

      <!-- Tarjetas KPI compactas - Combined -->
      <div class="user-history-kpi-section-compact">
        <h3 class="kpi-section-title">Combined (Stow to Prime + Transfer In)</h3>
        <div class="kpi-compact-grid">
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rate Combined</span>
            <span id="kpi-combined-rate" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">vs <span id="kpi-combined-avg">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Percentil</span>
            <span id="kpi-combined-percentile" class="kpi-compact-value">-</span>
            <div id="kpi-combined-percentile-bar" class="percentile-bar-compact"></div>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rank</span>
            <span id="kpi-combined-rank" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">de <span id="kpi-combined-total-users">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Diferencia</span>
            <span id="kpi-combined-difference" class="kpi-compact-value">-</span>
            <span id="kpi-combined-diff-indicator" class="kpi-compact-indicator">-</span>
          </div>
        </div>
      </div>

      <!-- Tarjetas KPI compactas - Stow to Prime -->
      <div class="user-history-kpi-section-compact">
        <h3 class="kpi-section-title">Stow to Prime</h3>
        <div class="kpi-compact-grid">
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rate Stow to Prime</span>
            <span id="kpi-stp-rate" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">vs <span id="kpi-stp-avg">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Percentil</span>
            <span id="kpi-stp-percentile" class="kpi-compact-value">-</span>
            <div id="kpi-stp-percentile-bar" class="percentile-bar-compact"></div>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rank</span>
            <span id="kpi-stp-rank" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">de <span id="kpi-stp-total-users">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Diferencia</span>
            <span id="kpi-stp-difference" class="kpi-compact-value">-</span>
            <span id="kpi-stp-diff-indicator" class="kpi-compact-indicator">-</span>
          </div>
        </div>
      </div>

      <!-- Tarjetas KPI compactas - Transfer In -->
      <div class="user-history-kpi-section-compact">
        <h3 class="kpi-section-title">Transfer In (TSI)</h3>
        <div class="kpi-compact-grid">
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rate Transfer In</span>
            <span id="kpi-ti-rate" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">vs <span id="kpi-ti-avg">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Percentil</span>
            <span id="kpi-ti-percentile" class="kpi-compact-value">-</span>
            <div id="kpi-ti-percentile-bar" class="percentile-bar-compact"></div>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rank</span>
            <span id="kpi-ti-rank" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">de <span id="kpi-ti-total-users">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Diferencia</span>
            <span id="kpi-ti-difference" class="kpi-compact-value">-</span>
            <span id="kpi-ti-diff-indicator" class="kpi-compact-indicator">-</span>
          </div>
        </div>
      </div>

      <!-- Gr谩ficos de Evoluci贸n Temporal -->
      <div class="user-history-charts-section">
        <h3 class="charts-section-title"> Evoluci贸n Temporal del Rendimiento</h3>
        
        <!-- Gr谩fico 1: Evoluci贸n Rate vs Promedio (L铆nea Temporal) -->
        <div class="user-history-chart-container full-width">
          <h4 class="chart-title">Evoluci贸n del Rate: Usuario vs Promedio General</h4>
          <div id="rate-evolution-chart" class="user-history-chart">
            <div style="padding: 20px; text-align: center; color: #666">
              <p>Selecciona un usuario para ver la evoluci贸n</p>
            </div>
          </div>
        </div>

        <!-- Gr谩fico 2: Comparaci贸n por Tipo de Tarea en cada Per铆odo -->
        <div class="user-history-chart-container full-width">
          <h4 class="chart-title">Comparaci贸n por Tipo de Tarea (Combined, Stow to Prime, Transfer In)</h4>
          <div id="task-comparison-evolution-chart" class="user-history-chart">
            <div style="padding: 20px; text-align: center; color: #666">
              <p>Comparaci贸n de tipos de tarea por per铆odo</p>
            </div>
          </div>
        </div>

        <!-- Gr谩fico 3: Evoluci贸n del Rank y Percentil -->
        <div class="user-history-chart-container">
          <h4 class="chart-title">Evoluci贸n del Rank</h4>
          <div id="rank-evolution-chart" class="user-history-chart">
            <div style="padding: 20px; text-align: center; color: #666">
              <p>Evoluci贸n del ranking</p>
            </div>
          </div>
        </div>

        <div class="user-history-chart-container">
          <h4 class="chart-title">Evoluci贸n del Percentil</h4>
          <div id="percentile-evolution-chart" class="user-history-chart">
            <div style="padding: 20px; text-align: center; color: #666">
              <p>Evoluci贸n del percentil</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/user-history.js"></script>
  </body>
</html>

