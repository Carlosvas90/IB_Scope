<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User History - Activity Scope</title>
    <!-- CSS se carga dinÃ¡micamente por el router -->
  </head>
  <body>
    <div class="user-history-container">
      <!-- Header compacto -->
      <header class="app-header-card">
        <h1>
          <span id="icon-history-header" class="icon-svg icon-32"></span>
          User History
        </h1>
        <div class="app-header-controls">
          <button id="refresh-history" class="btn btn-primary">
            <span id="icon-refresh-history" class="icon-svg icon-16"></span>
            Actualizar
          </button>
        </div>
      </header>

      <!-- Barra de filtros -->
      <div class="user-history-filters-compact">
        <div class="filters-row">
          <div class="filter-item filter-item-search">
            <label for="history-user-search">Buscar por Login:</label>
            <input
              type="text"
              id="history-user-search"
              class="form-control compact search-input"
              placeholder="Escribe el login..."
              autocomplete="off"
            />
            <label class="checkbox-inline">
              <input type="checkbox" id="history-only-active" checked />
              Solo Activos
            </label>
            <div id="user-search-suggestions" class="search-suggestions" style="display: none;"></div>
          </div>
          <div class="filter-item">
            <label for="history-shift-filter">Turno:</label>
            <select id="history-shift-filter" class="form-control compact">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="filter-item">
            <label for="history-manager-filter">Manager:</label>
            <select id="history-manager-filter" class="form-control compact">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="filter-item filter-item-user">
            <label for="history-user-select">Usuario:</label>
            <select id="history-user-select" class="form-control compact">
              <option value="">-- Seleccionar --</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Contenedor principal para ficha de usuario y mÃ©tricas -->
      <div id="selected-user-container" class="selected-user-container" style="display: none;">
        <!-- Ficha usuario (columna izquierda) -->
        <div id="selected-user-info-card" class="selected-user-info-card">
          <div class="user-info-photo-section">
            <div class="user-photo-large" id="selected-user-photo">
              <!-- Foto se cargarÃ¡ dinÃ¡micamente -->
            </div>
          </div>
          <div class="user-info-details-section">
            <div class="user-info-row">
              <span class="user-info-label">Login:</span>
              <span class="user-info-value" id="selected-user-login">-</span>
            </div>
            <div class="user-info-row">
              <span class="user-info-label">Nombre:</span>
              <span class="user-info-value" id="selected-user-name">-</span>
            </div>
            <div class="user-info-row">
              <span class="user-info-label">Turno:</span>
              <span class="user-info-value" id="selected-user-shift">-</span>
            </div>
            <div class="user-info-row">
              <span class="user-info-label">Manager:</span>
              <span class="user-info-value" id="selected-user-manager">-</span>
            </div>
          </div>
        </div>

        <!-- Panel de mÃ©tricas (columna derecha) -->
        <div class="user-metrics-panel">
          <h4 class="metrics-panel-title">MÃ©tricas por PerÃ­odo</h4>
          <table class="user-metrics-table">
            <thead>
              <tr>
                <th class="metric-period-header">PerÃ­odo</th>
                <th class="metric-type-header">ArtÃ­culos</th>
                <th class="metric-type-header">Horas</th>
                <th class="metric-type-header">Rank</th>
                <th class="metric-type-header">Rate</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="metric-period-label">Semana</td>
                <td class="metric-value-cell" id="metric-units-week">-</td>
                <td class="metric-value-cell" id="metric-hours-week">-</td>
                <td class="metric-value-cell" id="metric-rank-week">-</td>
                <td class="metric-value-cell" id="metric-rate-week">-</td>
              </tr>
              <tr>
                <td class="metric-period-label">Mes</td>
                <td class="metric-value-cell" id="metric-units-month">-</td>
                <td class="metric-value-cell" id="metric-hours-month">-</td>
                <td class="metric-value-cell" id="metric-rank-month">-</td>
                <td class="metric-value-cell" id="metric-rate-month">-</td>
              </tr>
              <tr>
                <td class="metric-period-label">3 Meses</td>
                <td class="metric-value-cell" id="metric-units-3months">-</td>
                <td class="metric-value-cell" id="metric-hours-3months">-</td>
                <td class="metric-value-cell" id="metric-rank-3months">-</td>
                <td class="metric-value-cell" id="metric-rate-3months">-</td>
              </tr>
              <tr>
                <td class="metric-period-label">6 Meses</td>
                <td class="metric-value-cell" id="metric-units-6months">-</td>
                <td class="metric-value-cell" id="metric-hours-6months">-</td>
                <td class="metric-value-cell" id="metric-rank-6months">-</td>
                <td class="metric-value-cell" id="metric-rate-6months">-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Selector de departamento (Receive, Stow, Pick, Pack, Shipping) -->
      <div id="department-buttons-wrap" class="department-buttons-wrap" style="display: none;">
        <span class="department-buttons-label">Departamento:</span>
        <div class="department-buttons">
          <button type="button" class="department-btn" data-department="receive">Receive</button>
          <button type="button" class="department-btn active" data-department="each_stow">Stow</button>
          <button type="button" class="department-btn" data-department="pick">Pick</button>
          <button type="button" class="department-btn" data-department="pack">Pack</button>
          <button type="button" class="department-btn" data-department="shipping">Shipping</button>
        </div>
      </div>

      <!-- Vista genÃ©rica (Receive, Pick, Pack, Shipping): evoluciÃ³n por departamento -->
      <div id="generic-charts-section" class="user-history-charts-section">
        <h3 class="charts-section-title">ðŸ“ˆ EvoluciÃ³n Temporal del Rendimiento</h3>
        <div class="user-history-charts-primary">
          <div class="user-history-chart-container">
            <h4 class="chart-title">EvoluciÃ³n del Rate: Usuario vs Promedio</h4>
            <div id="rate-evolution-chart" class="user-history-chart"></div>
          </div>
          <div class="user-history-chart-container">
            <h4 class="chart-title">EvoluciÃ³n del Percentil</h4>
            <div id="percentile-evolution-chart" class="user-history-chart"></div>
          </div>
          <div class="user-history-chart-container">
            <h4 class="chart-title">EvoluciÃ³n del Rate por Esfuerzo</h4>
            <div id="effort-rate-evolution-chart" class="user-history-chart"></div>
          </div>
        </div>
      </div>

      <!-- Stow: vista detallada en 3 niveles (solo visible cuando departamento = Stow) -->
      <div id="stow-detail-section" class="stow-detail-section" style="display: none;">
        <!-- Nivel 1: Tres principales -->
        <h3 class="charts-section-title">ðŸ“Š Stow â€“ Nivel 1 (Principales)</h3>
        <div class="stow-level1-grid">
          <div class="stow-level1-block" data-block="combined">
            <h4 class="stow-block-title">Stow Combined</h4>
            <div class="stow-metric-selector-wrap stow-metric-inline">
              <span class="stow-metric-label">Mostrar:</span>
              <div id="stow-combined-metric-selector" class="stow-metric-selector"></div>
            </div>
            <div id="stow-combined-chart" class="user-history-chart"></div>
            <span class="stow-kpi-period-label">Datos del perÃ­odo:</span>
            <div id="stow-combined-period-selector" class="stow-period-selector"></div>
            <div id="stow-combined-kpis" class="stow-kpi-row"></div>
          </div>
          <div class="stow-level1-block" data-block="pallet">
            <h4 class="stow-block-title">Pallet Stow Combined</h4>
            <div class="stow-metric-selector-wrap stow-metric-inline">
              <span class="stow-metric-label">Mostrar:</span>
              <div id="stow-pallet-combined-metric-selector" class="stow-metric-selector"></div>
            </div>
            <div id="stow-pallet-combined-chart" class="user-history-chart"></div>
            <span class="stow-kpi-period-label">Datos del perÃ­odo:</span>
            <div id="stow-pallet-combined-period-selector" class="stow-period-selector"></div>
            <div id="stow-pallet-combined-kpis" class="stow-kpi-row"></div>
          </div>
          <div class="stow-level1-block" data-block="esfuerzo">
            <h4 class="stow-block-title">Esfuerzo</h4>
            <div id="stow-esfuerzo-chart" class="user-history-chart"></div>
            <span class="stow-kpi-period-label">Datos del perÃ­odo:</span>
            <div id="stow-esfuerzo-period-selector" class="stow-period-selector"></div>
            <div id="stow-esfuerzo-kpis" class="stow-kpi-row"></div>
            <div id="stow-esfuerzo-extra" class="stow-kpi-row stow-kpi-extra"></div>
          </div>
        </div>

        <!-- Nivel 2: Each Stow por tipo (evoluciÃ³n en el tiempo vs promedio) -->
        <h3 class="charts-section-title">ðŸ“Š Stow â€“ Nivel 2: Each Stow por tipo (Usuario vs Promedio)</h3>
        <div class="stow-level2-block">
          <div class="stow-metric-selector-wrap">
            <span class="stow-metric-label">Mostrar en grÃ¡ficos:</span>
            <div id="each-stow-metric-selector" class="stow-metric-selector"></div>
          </div>
          <div id="each-stow-charts-grid" class="stow-level2-charts-grid"></div>
          <div id="each-stow-comparison-table-wrap" class="stow-table-wrap">
            <table id="each-stow-comparison-table" class="stow-comparison-table"></table>
          </div>
        </div>

        <h3 class="charts-section-title">ðŸ“Š Stow â€“ Nivel 2: Pallet Stow por tipo (Usuario vs Promedio)</h3>
        <div class="stow-level2-block">
          <div class="stow-metric-selector-wrap">
            <span class="stow-metric-label">Mostrar en grÃ¡ficos:</span>
            <div id="pallet-stow-metric-selector" class="stow-metric-selector"></div>
          </div>
          <div id="pallet-stow-charts-grid" class="stow-level2-charts-grid"></div>
          <div id="pallet-stow-comparison-table-wrap" class="stow-table-wrap">
            <table id="pallet-stow-comparison-table" class="stow-comparison-table"></table>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/user-history.js"></script>
  </body>
</html>

