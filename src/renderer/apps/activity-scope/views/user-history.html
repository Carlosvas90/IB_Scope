<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User History - Activity Scope</title>
    <!-- CSS se carga din치micamente por el router -->
  </head>
  <body>
    <div class="user-history-container">
      <!-- Header compacto -->
      <header class="app-header-card">
        <h1>
          <span id="icon-history-header" class="icon-svg icon-32"></span>
          User History
        </h1>
        <div class="app-header-controls">
          <button id="refresh-history" class="btn btn-primary">
            <span id="icon-refresh-history" class="icon-svg icon-16"></span>
            Actualizar
          </button>
        </div>
      </header>

      <!-- Filtros compactos en una l칤nea -->
      <div class="user-history-filters-compact">
        <div class="filters-row">
          <!-- B칰squeda por login (PRIMERO, no afectada por filtros) -->
          <div class="filter-item filter-item-search">
            <label for="history-user-search">Buscar por Login:</label>
            <input 
              type="text" 
              id="history-user-search" 
              class="form-control compact search-input" 
              placeholder="Escribe el login..."
              autocomplete="off"
            />
            <div id="user-search-suggestions" class="search-suggestions" style="display: none;"></div>
          </div>
          <div class="filter-item">
            <label for="history-shift-filter">Turno:</label>
            <select id="history-shift-filter" class="form-control compact">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="filter-item">
            <label for="history-manager-filter">Manager:</label>
            <select id="history-manager-filter" class="form-control compact">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="filter-item filter-item-user">
            <label for="history-user-select">Usuario:</label>
            <select id="history-user-select" class="form-control compact">
              <option value="">-- Seleccionar --</option>
            </select>
          </div>
          <div class="filter-item filter-item-period">
            <div class="period-buttons-compact">
              <button class="period-btn-compact active" data-period="last_week">Semana</button>
              <button class="period-btn-compact" data-period="last_month">Mes</button>
              <button class="period-btn-compact" data-period="last_3_months">3 Meses</button>
              <button class="period-btn-compact" data-period="last_6_months">6 Meses</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Contenedor principal para ficha de usuario y m칠tricas -->
      <div id="selected-user-container" class="selected-user-container" style="display: none;">
        <!-- Ficha usuario (columna izquierda) -->
        <div id="selected-user-info-card" class="selected-user-info-card">
          <div class="user-info-photo-section">
            <div class="user-photo-large" id="selected-user-photo">
              <!-- Foto se cargar치 din치micamente -->
            </div>
          </div>
          <div class="user-info-details-section">
            <div class="user-info-row">
              <span class="user-info-label">Login:</span>
              <span class="user-info-value" id="selected-user-login">-</span>
            </div>
            <div class="user-info-row">
              <span class="user-info-label">Nombre:</span>
              <span class="user-info-value" id="selected-user-name">-</span>
            </div>
            <div class="user-info-row">
              <span class="user-info-label">Turno:</span>
              <span class="user-info-value" id="selected-user-shift">-</span>
            </div>
            <div class="user-info-row">
              <span class="user-info-label">Manager:</span>
              <span class="user-info-value" id="selected-user-manager">-</span>
            </div>
          </div>
        </div>

        <!-- Panel de m칠tricas (columna derecha) -->
        <div class="user-metrics-panel">
          <h4 class="metrics-panel-title">M칠tricas por Per칤odo</h4>
          <table class="user-metrics-table">
            <thead>
              <tr>
                <th class="metric-period-header">Per칤odo</th>
                <th class="metric-type-header">Art칤culos</th>
                <th class="metric-type-header">Horas</th>
                <th class="metric-type-header">Rank</th>
                <th class="metric-type-header">Rate</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="metric-period-label">Semana</td>
                <td class="metric-value-cell" id="metric-units-week">-</td>
                <td class="metric-value-cell" id="metric-hours-week">-</td>
                <td class="metric-value-cell" id="metric-rank-week">-</td>
                <td class="metric-value-cell" id="metric-rate-week">-</td>
              </tr>
              <tr>
                <td class="metric-period-label">Mes</td>
                <td class="metric-value-cell" id="metric-units-month">-</td>
                <td class="metric-value-cell" id="metric-hours-month">-</td>
                <td class="metric-value-cell" id="metric-rank-month">-</td>
                <td class="metric-value-cell" id="metric-rate-month">-</td>
              </tr>
              <tr>
                <td class="metric-period-label">3 Meses</td>
                <td class="metric-value-cell" id="metric-units-3months">-</td>
                <td class="metric-value-cell" id="metric-hours-3months">-</td>
                <td class="metric-value-cell" id="metric-rank-3months">-</td>
                <td class="metric-value-cell" id="metric-rate-3months">-</td>
              </tr>
              <tr>
                <td class="metric-period-label">6 Meses</td>
                <td class="metric-value-cell" id="metric-units-6months">-</td>
                <td class="metric-value-cell" id="metric-hours-6months">-</td>
                <td class="metric-value-cell" id="metric-rank-6months">-</td>
                <td class="metric-value-cell" id="metric-rate-6months">-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Gr치ficos de Evoluci칩n Temporal (arriba) -->
      <div class="user-history-charts-section">
        <h3 class="charts-section-title">游늳 Evoluci칩n Temporal del Rendimiento</h3>
        
        <!-- Gr치ficos principales juntos: Rate y Percentil -->
        <div class="user-history-charts-primary">
          <!-- Gr치fico 1: Evoluci칩n Rate vs Promedio (L칤nea Temporal) -->
          <div class="user-history-chart-container">
            <h4 class="chart-title">Evoluci칩n del Rate: Usuario vs Promedio General</h4>
            <div id="rate-evolution-chart" class="user-history-chart">
              <div style="padding: 20px; text-align: center; color: #666">
                <p>Selecciona un usuario para ver la evoluci칩n</p>
              </div>
            </div>
          </div>

          <!-- Gr치fico 2: Evoluci칩n del Percentil -->
          <div class="user-history-chart-container">
            <h4 class="chart-title">Evoluci칩n del Percentil</h4>
            <div id="percentile-evolution-chart" class="user-history-chart">
              <div style="padding: 20px; text-align: center; color: #666">
                <p>Evoluci칩n del percentil</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Gr치fico 3: Comparaci칩n por Tipo de Tarea en cada Per칤odo -->
        <div class="user-history-chart-container full-width">
          <h4 class="chart-title">Comparaci칩n por Tipo de Tarea (Combined, Stow to Prime, Transfer In)</h4>
          <div id="task-comparison-evolution-chart" class="user-history-chart">
            <div style="padding: 20px; text-align: center; color: #666">
              <p>Comparaci칩n de tipos de tarea por per칤odo</p>
            </div>
          </div>
        </div>

        <!-- Gr치fico 4: Evoluci칩n del Rank -->
        <div class="user-history-chart-container">
          <h4 class="chart-title">Evoluci칩n del Rank</h4>
          <div id="rank-evolution-chart" class="user-history-chart">
            <div style="padding: 20px; text-align: center; color: #666">
              <p>Evoluci칩n del ranking</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tarjetas KPI compactas - Combined (al final) -->
      <div class="user-history-kpi-section-compact">
        <h3 class="kpi-section-title">Combined (Stow to Prime + Transfer In)</h3>
        <div class="kpi-compact-grid">
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rate Combined</span>
            <span id="kpi-combined-rate" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">vs <span id="kpi-combined-avg">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Percentil</span>
            <span id="kpi-combined-percentile" class="kpi-compact-value">-</span>
            <div id="kpi-combined-percentile-bar" class="percentile-bar-compact"></div>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rank</span>
            <span id="kpi-combined-rank" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">de <span id="kpi-combined-total-users">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Diferencia</span>
            <span id="kpi-combined-difference" class="kpi-compact-value">-</span>
            <span id="kpi-combined-diff-indicator" class="kpi-compact-indicator">-</span>
          </div>
        </div>
      </div>

      <!-- Tarjetas KPI compactas - Stow to Prime (al final) -->
      <div class="user-history-kpi-section-compact">
        <h3 class="kpi-section-title">Stow to Prime</h3>
        <div class="kpi-compact-grid">
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rate Stow to Prime</span>
            <span id="kpi-stp-rate" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">vs <span id="kpi-stp-avg">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Percentil</span>
            <span id="kpi-stp-percentile" class="kpi-compact-value">-</span>
            <div id="kpi-stp-percentile-bar" class="percentile-bar-compact"></div>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rank</span>
            <span id="kpi-stp-rank" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">de <span id="kpi-stp-total-users">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Diferencia</span>
            <span id="kpi-stp-difference" class="kpi-compact-value">-</span>
            <span id="kpi-stp-diff-indicator" class="kpi-compact-indicator">-</span>
          </div>
        </div>
      </div>

      <!-- Tarjetas KPI compactas - Transfer In (al final) -->
      <div class="user-history-kpi-section-compact">
        <h3 class="kpi-section-title">Transfer In (TSI)</h3>
        <div class="kpi-compact-grid">
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rate Transfer In</span>
            <span id="kpi-ti-rate" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">vs <span id="kpi-ti-avg">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Percentil</span>
            <span id="kpi-ti-percentile" class="kpi-compact-value">-</span>
            <div id="kpi-ti-percentile-bar" class="percentile-bar-compact"></div>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Rank</span>
            <span id="kpi-ti-rank" class="kpi-compact-value">-</span>
            <span class="kpi-compact-sub">de <span id="kpi-ti-total-users">-</span></span>
          </div>
          <div class="kpi-compact-card">
            <span class="kpi-compact-label">Diferencia</span>
            <span id="kpi-ti-difference" class="kpi-compact-value">-</span>
            <span id="kpi-ti-diff-indicator" class="kpi-compact-indicator">-</span>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/user-history.js"></script>
  </body>
</html>

