<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stats - Feedback Tracker</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="../css/stats.css" />

    <!-- ECharts Library -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  </head>
  <body>
    <div class="stats-container">
      <!-- Header -->
      <header class="stats-header">
        <h1>
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"
              fill="currentColor"
            />
          </svg>
          Stats Dashboard
        </h1>
        <div class="header-controls">
          <div class="date-range-selector">
            <label for="date-range">Período:</label>
            <select id="date-range">
              <option value="0" selected>Hoy</option>
              <option value="7">Últimos 7 días</option>
              <option value="30">Últimos 30 días</option>
              <option value="90">Últimos 90 días</option>
              <option value="365">Último año</option>
            </select>
          </div>
          <button class="btn-refresh" id="refresh-stats">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
                fill="currentColor"
              />
            </svg>
            Actualizar
          </button>
        </div>
      </header>

      <!-- KPI Cards -->
      <section class="kpi-grid">
        <!-- Total de Errores con Promedio Diario como secundario -->
        <div class="kpi-card total-errors">
          <div class="kpi-icon">
            <svg
              width="40"
              height="40"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="kpi-content">
            <h3>Total de Errores</h3>
            <div class="kpi-value" id="total-errors-kpi">-</div>
            <div class="kpi-trend neutral" id="total-errors-trend">
              Cargando...
            </div>
            <!-- KPI Secundario: Promedio Diario -->
            <div class="kpi-secondary">
              <h4>Promedio Diario</h4>
              <div class="kpi-value secondary" id="daily-avg-kpi">-</div>
              <div class="kpi-trend neutral" id="daily-avg-trend">
                Cargando...
              </div>
            </div>
          </div>
        </div>

        <!-- Errores Pendientes con Tasa de Resolución como secundario -->
        <div class="kpi-card pending-errors">
          <div class="kpi-icon">
            <svg
              width="40"
              height="40"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,7H13V13H11V7M11,15H13V17H11V15Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="kpi-content">
            <h3>Errores Pendientes</h3>
            <div class="kpi-value" id="pending-errors-kpi">-</div>
            <div class="kpi-trend neutral" id="pending-errors-trend">
              Cargando...
            </div>
            <!-- KPI Secundario: Tasa de Resolución -->
            <div class="kpi-secondary">
              <h4>Tasa de Resolución</h4>
              <div class="kpi-value secondary" id="resolution-rate-kpi">-</div>
              <div class="kpi-trend neutral" id="resolution-rate-trend">
                Cargando...
              </div>
            </div>
          </div>
        </div>

        <!-- Errores Resueltos (sin KPI secundario) -->
        <div class="kpi-card resolved-errors">
          <div class="kpi-icon">
            <svg
              width="40"
              height="40"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="kpi-content">
            <h3>Errores Resueltos</h3>
            <div class="kpi-value" id="resolved-errors-kpi">-</div>
            <div class="kpi-trend neutral" id="resolved-errors-trend">
              Cargando...
            </div>
          </div>
        </div>
      </section>

      <!-- Loading Overlay -->
      <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
          <div class="loading-spinner"></div>
          <p>Cargando datos...</p>
        </div>
      </div>

      <!-- No Data Message -->
      <div id="no-data-overlay" class="no-data-overlay" style="display: none">
        <div class="no-data-content">
          <div class="no-data-icon">
            <svg
              width="64"
              height="64"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                fill="currentColor"
                opacity="0.3"
              />
            </svg>
          </div>
          <h3>No hay datos disponibles</h3>
          <p>No se encontraron datos de errores para mostrar.</p>
          <p>Asegúrate de que:</p>
          <ul>
            <li>La aplicación Feedback Tracker tenga datos cargados</li>
            <li>Existan archivos JSON con datos del período seleccionado</li>
          </ul>
          <button class="btn-refresh" id="retry-load-data">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
                fill="currentColor"
              />
            </svg>
            Reintentar
          </button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="../js/stats.js"></script>
  </body>
</html>
